<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chatterino Callback</title>
    <script>
      const hash = location.hash;
      const query = location.search;
      history.replaceState(null, "", location.pathname);
      (async () => {
        function* chain(...it) {
          for (const iter of it) yield* iter;
        }
        const response = await fetch("/data", {
          method: "POST",
          body: JSON.stringify(
            Object.fromEntries(
              chain(
                new URLSearchParams(query.substring(1)).entries(),
                new URLSearchParams(hash.substring(1)).entries()
              )
            )
          ),
          headers: {
            "Content-Type": "application/json",
          },
        });
        window.close();
      })();
    </script>
  </head>
  <body></body>
</html>
